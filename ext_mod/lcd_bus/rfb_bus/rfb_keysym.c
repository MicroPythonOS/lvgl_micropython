/* Copyright (C) 2024  Kevin G Schlosser
 * Code that is written by thE above named is done under the GPL license
 * and that license is able to be viewed in the LICENSE file in the root
 * of this project.
 */

/* This code is based from code that is found in the SDL library. */


#include "rfb_keysym.h"


uint8_t rfb_keysym_to_ascii(uint32_t keysym, rfb_key_t *data)
{
    /* Check if the key is an ascii key or some kind of a control key.
       If not reject it. */
    if (((keysym >> 8) & 0xFF) != 0xFF && ((keysym >> 8) & 0xFF) != 0x00) {
        return 0;
    }

    /* Reassign control keys that are not in the ascii range.
       This is specific to my application but useful nonbe the less */
    switch (keysym) {
        case 0xFF50: /* XK_Home */
        case 0xFF95: /* XK_KP_Home */
            keysym = 0x02; /* STX */
            break;

        case 0xFF57: /* XK_End */
        case 0xFF9C: /* XK_KP_End */
            keysym = 0x03; /* ETX */
            break;

        case 0xFF08: /* XK_BackSpace */
            keysym = 0x08; /* BS */
            break;

        case 0xFF09: /* XK_Tab */
        case 0xFF56: /* XK_Next */
        case 0xFF89: /* XK_KP_Tab */
        case 0xFF9B: /* XK_KP_Next */
            keysym = 0x09; /* HT */
            break;

        case 0xFF0A: /* XK_Linefeed */
            keysym = 0x0A /* \n */
            break;

        case 0xFF55: /* XK_Prior */
        case 0xFF9A: /* XK_KP_Prior */
            keysym = 0x0B; /* VT */
            break;

        case 0xFF0D: /* XK_Enter */
        case 0xFF8D: /* XK_KP_Enter */
            keysym = 0x0D; /* CR */
            break;

        case 0xFF52: /* XK_Up */
        case 0xFF97: /* XK_KP_Up */
            keysym = 0x11; /* DC1 */
            break;

        case 0xFF54: /* XK_Down */
        case 0xFF99: /* XK_KP_Down */
            keysym = 0x12; /* DC2 */
            break;

        case 0xFF53: /* XK_Right */
        case 0xFF98: /* XK_KP_Right */
            keysym = 0x13; /* DC3 */
            break;

        case 0xFF51: /* XK_Left */
        case 0xFF96: /* XK_KP_Left */
            keysym = 0x14; /* DC4 */
            break;

        case 0xFF1B: /* XK_Escape */
            keysym = 0x1B /* Escape */
            break;

        case 0xFFFF: /* XK_Delete */
        case 0xFF9F: /* XK_KP_Delete */
            keysym = 0x7F; /* DEL */
            break;

        case 0xFF80:
            keysym = 0x20; /* XK_KP_Space */
            break;

        case 0xFFBD: /* XK_KP_Equal */
            keysym = 0x3D;
            break;
    }

    /* Reassign numeric keypad keys into the ascii range
       This is specific to my application. */
    if (keysym >= 0xFFAA && keysym <= 0xFFB9) {
        keysym = (keysym & 0xFF) - 0x80;
    }

    /* Filter all the non ascii keys out since we moved
       the ones we want to use into the ascii range. */
    if (((keysym >> 8) & 0xFF) == 0xFF) {
        return 0;
    }

    data->ascii = (uint8_t)(keysym & 0xFF);
    return 1;
}


uint8_t rfb_keysym_to_utf(uint32_t keysym, rfb_key_t *data)
{
    /* reject ascii keys and control keys */
    if (((keysym >> 8) & 0xFF) < 0x01 || ((keysym >> 8) & 0xFF) > 0x20) {
        return 0;
    }

    /* 'utf keysym' */
    if ((keysym & 0xFF000000) == 0x01000000) {
        data->utf = (uint32_t)(keysym & 0x00FFFFFF);
    } else if (keysym > 0x01A0 && keysym < 0x0200) {
        uint16_t utf_01A1_01FF[] = {
                    0x0104, 0x02D8, 0x0141, 0x0000, 0x013D, 0x015A, 0x0000, /* 0x01A0-0x01A7 */
            0x0000, 0x0160, 0x015E, 0x0164, 0x0179, 0x0000, 0x017D, 0x017B, /* 0x01A8-0x01AF */
            0x0000, 0x0105, 0x02DB, 0x0142, 0x0000, 0x013E, 0x015B, 0x02C7, /* 0x01B0-0x01B7 */
            0x0000, 0x0161, 0x015F, 0x0165, 0x017A, 0x02DD, 0x017E, 0x017C, /* 0x01B8-0x01BF */
            0x0154, 0x0000, 0x0000, 0x0102, 0x0000, 0x0139, 0x0106, 0x0000, /* 0x01C0-0x01C7 */
            0x010C, 0x0000, 0x0118, 0x0000, 0x011A, 0x0000, 0x0000, 0x010E, /* 0x01C8-0x01CF */
            0x0110, 0x0143, 0x0147, 0x0000, 0x0000, 0x0150, 0x0000, 0x0000, /* 0x01D0-0x01D7 */
            0x0158, 0x016E, 0x0000, 0x0170, 0x0000, 0x0000, 0x0162, 0x0000, /* 0x01D8-0x01DF */
            0x0155, 0x0000, 0x0000, 0x0103, 0x0000, 0x013A, 0x0107, 0x0000, /* 0x01E0-0x01E7 */
            0x010D, 0x0000, 0x0119, 0x0000, 0x011B, 0x0000, 0x0000, 0x010F, /* 0x01E8-0x01EF */
            0x0111, 0x0144, 0x0148, 0x0000, 0x0000, 0x0151, 0x0000, 0x0000, /* 0x01F0-0x01F7 */
            0x0159, 0x016F, 0x0000, 0x0171, 0x0000, 0x0000, 0x0163, 0x02D9  /* 0x01F8-0x01FF */
        };
        data->utf = (uint32_t)utf_01A1_01FF[keysym - 0x01A1];
    } else if (keysym > 0x02A0 && keysym < 0x02FF) {
        uint16_t utf_02A1_02FE[] = {
                    0x0126, 0x0000, 0x0000, 0x0000, 0x0000, 0x0124, 0x0000, /* 0x02A0-0x02A7 */
            0x0000, 0x0130, 0x0000, 0x011E, 0x0134, 0x0000, 0x0000, 0x0000, /* 0x02A8-0x02AF */
            0x0000, 0x0127, 0x0000, 0x0000, 0x0000, 0x0000, 0x0125, 0x0000, /* 0x02B0-0x02B7 */
            0x0000, 0x0131, 0x0000, 0x011F, 0x0135, 0x0000, 0x0000, 0x0000, /* 0x02B8-0x02BF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x010A, 0x0108, 0x0000, /* 0x02C0-0x02C7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x02C8-0x02CF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0120, 0x0000, 0x0000, /* 0x02D0-0x02D7 */
            0x011C, 0x0000, 0x0000, 0x0000, 0x0000, 0x016C, 0x015C, 0x0000, /* 0x02D8-0x02DF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x010B, 0x0109, 0x0000, /* 0x02E0-0x02E7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x02E8-0x02EF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0121, 0x0000, 0x0000, /* 0x02F0-0x02F7 */
            0x011D, 0x0000, 0x0000, 0x0000, 0x0000, 0x016D, 0x015D          /* 0x02F8-0x02FF */
        };
        data->utf = (uint32_t)utf_02A1_02FE[keysym - 0x02A1];
    } else if (keysym > 0x03A1 && keysym < 0x03FF) {
        uint16_t utf_03A2_03FE[] = {
                            0x0138, 0x0156, 0x0000, 0x0128, 0x013B, 0x0000, /* 0x03A0-0x03A7 */
            0x0000, 0x0000, 0x0112, 0x0122, 0x0166, 0x0000, 0x0000, 0x0000, /* 0x03A8-0x03AF */
            0x0000, 0x0000, 0x0000, 0x0157, 0x0000, 0x0129, 0x013C, 0x0000, /* 0x03B0-0x03B7 */
            0x0000, 0x0000, 0x0113, 0x0123, 0x0167, 0x014A, 0x0000, 0x014B, /* 0x03B8-0x03BF */
            0x0100, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x012E, /* 0x03C0-0x03C7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0116, 0x0000, 0x0000, 0x012A, /* 0x03C8-0x03CF */
            0x0000, 0x0145, 0x014C, 0x0136, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x03D0-0x03D7 */
            0x0000, 0x0172, 0x0000, 0x0000, 0x0000, 0x0168, 0x016A, 0x0000, /* 0x03D8-0x03DF */
            0x0101, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x012F, /* 0x03E0-0x03E7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0117, 0x0000, 0x0000, 0x012B, /* 0x03E8-0x03EF */
            0x0000, 0x0146, 0x014D, 0x0137, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x03F0-0x03F7 */
            0x0000, 0x0173, 0x0000, 0x0000, 0x0000, 0x0169, 0x016B          /* 0x03F8-0x03FF */
        };
        data->utf = (uint32_t)utf_03A2_03FE[keysym - 0x03A2];
    } else if (keysym > 0x04A0 && keysym < 0x04E0) {
        uint16_t utf_04A1_04DF[] = {
                    0x3002, 0x3008, 0x3009, 0x3001, 0x30FB, 0x30F2, 0x30A1, /* 0x04A0-0x04A7 */
            0x30A3, 0x30A5, 0x30A7, 0x30A9, 0x30E3, 0x30E5, 0x30E7, 0x30C3, /* 0x04A8-0x04AF */
            0x30FC, 0x30A2, 0x30A4, 0x30A6, 0x30A8, 0x30AA, 0x30AB, 0x30AD, /* 0x04B0-0x04B7 */
            0x30AF, 0x30B1, 0x30B3, 0x30B5, 0x30B7, 0x30B9, 0x30BB, 0x30BD, /* 0x04B8-0x04BF */
            0x30BF, 0x30C1, 0x30C4, 0x30C6, 0x30C8, 0x30CA, 0x30CB, 0x30CC, /* 0x04C0-0x04C7 */
            0x30CD, 0x30CE, 0x30CF, 0x30D2, 0x30D5, 0x30D8, 0x30DB, 0x30DE, /* 0x04C8-0x04CF */
            0x30DF, 0x30E0, 0x30E1, 0x30E2, 0x30E4, 0x30E6, 0x30E8, 0x30E9, /* 0x04D0-0x04D7 */
            0x30EA, 0x30EB, 0x30EC, 0x30ED, 0x30EF, 0x30F3, 0x309B, 0x309C  /* 0x04D8-0x04DF */
        };
        data->utf = (uint32_t)utf_04A1_04DF[keysym - 0x04A1];
    } else if (keysym > 0x0589 && keysym < 0x05FF) {
        uint16_t utf_0590_05FE[] = {
            0x06F0, 0x06F1, 0x06F2, 0x06F3, 0x06F4, 0x06F5, 0x06F6, 0x06F7, /* 0x0590-0x0597 */
            0x06F8, 0x06F9, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x0598-0x059F */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x066A, 0x0670, 0x0679, /* 0x05A0-0x05A7 */
            0x067E, 0x0686, 0x0688, 0x0691, 0x060C, 0x0000, 0x06D4, 0x0000, /* 0x05AC-0x05AF */
            0x0660, 0x0661, 0x0662, 0x0663, 0x0664, 0x0665, 0x0666, 0x0667, /* 0x05B0-0x05B7 */
            0x0668, 0x0669, 0x0000, 0x061B, 0x0000, 0x0000, 0x0000, 0x061F, /* 0x05B8-0x05BF */
            0x0000, 0x0621, 0x0622, 0x0623, 0x0624, 0x0625, 0x0626, 0x0627, /* 0x05C0-0x05C7 */
            0x0628, 0x0629, 0x062A, 0x062B, 0x062C, 0x062D, 0x062E, 0x062F, /* 0x05C8-0x05CF */
            0x0630, 0x0631, 0x0632, 0x0633, 0x0634, 0x0635, 0x0636, 0x0637, /* 0x05D0-0x05D7 */
            0x0638, 0x0639, 0x063A, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x05D8-0x05DF */
            0x0640, 0x0641, 0x0642, 0x0643, 0x0644, 0x0645, 0x0646, 0x0647, /* 0x05E0-0x05E7 */
            0x0648, 0x0649, 0x064A, 0x064B, 0x064C, 0x064D, 0x064E, 0x064F, /* 0x05E8-0x05EF */
            0x0650, 0x0651, 0x0652, 0x0653, 0x0654, 0x0655, 0x0698, 0x06A4, /* 0x05F0-0x05F7 */
            0x06A9, 0x06AF, 0x06BA, 0x06BE, 0x06CC, 0x06D2, 0x06C1          /* 0x05F8-0x05FE */
        };
        data->utf = (uint32_t)utf_0590_05FE[keysym - 0x0590];
    } else if (keysym > 0x067F && keysym < 0x0700) {
        uint16_t utf_0680_06FF[] = {
            0x0492, 0x0496, 0x049A, 0x049C, 0x04A2, 0x04AE, 0x04B0, 0x04B2, /* 0x0680-0x0687 */
            0x04B6, 0x04B8, 0x04BA, 0x0000, 0x04D8, 0x04E2, 0x04E8, 0x04EE, /* 0x0688-0x068F */
            0x0493, 0x0497, 0x049B, 0x049D, 0x04A3, 0x04AF, 0x04B1, 0x04B3, /* 0x0690-0x0697 */
            0x04B7, 0x04B9, 0x04BB, 0x0000, 0x04D9, 0x04E3, 0x04E9, 0x04EF, /* 0x0698-0x069F */
            0x0000, 0x0452, 0x0453, 0x0451, 0x0454, 0x0455, 0x0456, 0x0457, /* 0x06A0-0x06A7 */
            0x0458, 0x0459, 0x045A, 0x045B, 0x045C, 0x0491, 0x045E, 0x045F, /* 0x06A8-0x06AF */
            0x2116, 0x0402, 0x0403, 0x0401, 0x0404, 0x0405, 0x0406, 0x0407, /* 0x06B0-0x06B7 */
            0x0408, 0x0409, 0x040A, 0x040B, 0x040C, 0x0490, 0x040E, 0x040F, /* 0x06B8-0x06BF */
            0x044E, 0x0430, 0x0431, 0x0446, 0x0434, 0x0435, 0x0444, 0x0433, /* 0x06C0-0x06C7 */
            0x0445, 0x0438, 0x0439, 0x043A, 0x043B, 0x043C, 0x043D, 0x043E, /* 0x06C8-0x06CF */
            0x043F, 0x044F, 0x0440, 0x0441, 0x0442, 0x0443, 0x0436, 0x0432, /* 0x06D0-0x06D7 */
            0x044C, 0x044B, 0x0437, 0x0448, 0x044D, 0x0449, 0x0447, 0x044A, /* 0x06D8-0x06DF */
            0x042E, 0x0410, 0x0411, 0x0426, 0x0414, 0x0415, 0x0424, 0x0413, /* 0x06E0-0x06E7 */
            0x0425, 0x0418, 0x0419, 0x041A, 0x041B, 0x041C, 0x041D, 0x041E, /* 0x06E8-0x06EF */
            0x041F, 0x042F, 0x0420, 0x0421, 0x0422, 0x0423, 0x0416, 0x0412, /* 0x06F0-0x06F7 */
            0x042C, 0x042B, 0x0417, 0x0428, 0x042D, 0x0429, 0x0427, 0x042A  /* 0x06F8-0x06FF */
        };
        data->utf = (uint32_t)utf_0680_06FF[keysym - 0x0680];
    } else if (keysym > 0x07A0 && keysym < 0x07FA) {
        uint16_t utf_07A1_07F9[] = {
                    0x0386, 0x0388, 0x0389, 0x038A, 0x03AA, 0x0000, 0x038C, /* 0x07A0-0x07A7 */
            0x038E, 0x03AB, 0x0000, 0x038F, 0x0000, 0x0000, 0x0385, 0x2015, /* 0x07A8-0x07AF */
            0x0000, 0x03AC, 0x03AD, 0x03AE, 0x03AF, 0x03CA, 0x0390, 0x03CC, /* 0x07B0-0x07B7 */
            0x03CD, 0x03CB, 0x03B0, 0x03CE, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x07B8-0x07BF */
            0x0000, 0x0391, 0x0392, 0x0393, 0x0394, 0x0395, 0x0396, 0x0397, /* 0x07C0-0x07C7 */
            0x0398, 0x0399, 0x039A, 0x039B, 0x039C, 0x039D, 0x039E, 0x039F, /* 0x07C8-0x07CF */
            0x03A0, 0x03A1, 0x03A3, 0x0000, 0x03A4, 0x03A5, 0x03A6, 0x03A7, /* 0x07D0-0x07D7 */
            0x03A8, 0x03A9, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x07D8-0x07DF */
            0x0000, 0x03B1, 0x03B2, 0x03B3, 0x03B4, 0x03B5, 0x03B6, 0x03B7, /* 0x07E0-0x07E7 */
            0x03B8, 0x03B9, 0x03BA, 0x03BB, 0x03BC, 0x03BD, 0x03BE, 0x03BF, /* 0x07E8-0x07EF */
            0x03C0, 0x03C1, 0x03C3, 0x03C2, 0x03C4, 0x03C5, 0x03C6, 0x03C7, /* 0x07F0-0x07F7 */
            0x03C8, 0x03C9                                                  /* 0x07F8-0x07FF */
        };
        data->utf = (uint32_t)utf_07A1_07F9[keysym - 0x07A1];
    } else if (keysym > 0x08A3 && keysym < 0x08FF) {
        uint16_t utf_08A4_08FE[] = {
                                            0x2320, 0x2321, 0x0000, 0x231C, /* 0x08A0-0x08A7 */
            0x231D, 0x231E, 0x231F, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x08A8-0x08AF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x08B0-0x08B7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x2264, 0x2260, 0x2265, 0x222B, /* 0x08B8-0x08BF */
            0x2234, 0x0000, 0x221E, 0x0000, 0x0000, 0x2207, 0x0000, 0x0000, /* 0x08C0-0x08C7 */
            0x2245, 0x2246, 0x0000, 0x0000, 0x0000, 0x0000, 0x21D2, 0x0000, /* 0x08C8-0x08CF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x221A, 0x0000, /* 0x08D0-0x08D7 */
            0x0000, 0x0000, 0x2282, 0x2283, 0x2229, 0x222A, 0x2227, 0x2228, /* 0x08D8-0x08DF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x08E0-0x08E7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x2202, /* 0x08E8-0x08EF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0192, 0x0000, /* 0x08F0-0x08F7 */
            0x0000, 0x0000, 0x0000, 0x2190, 0x2191, 0x2192, 0x2193          /* 0x08F8-0x08FF */
        };
        data->utf = (uint32_t)utf_08A4_08FE[keysym - 0x08A4];
    } else if (keysym > 0x09DE && keysym < 0x09F9) {
        uint16_t utf_09DF_09F8[] = {
                                                                    0x2422, /* 0x09D8-0x09DF */
            0x2666, 0x25A6, 0x2409, 0x240C, 0x240D, 0x240A, 0x0000, 0x0000, /* 0x09E0-0x09E7 */
            0x240A, 0x240B, 0x2518, 0x2510, 0x250C, 0x2514, 0x253C, 0x2500, /* 0x09E8-0x09EF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x251C, 0x2524, 0x2534, 0x252C, /* 0x09F0-0x09F7 */
            0x2502                                                          /* 0x09F8-0x09FF */
        };
        data->utf = (uint32_t)utf_09DF_09F8[keysym - 0x09DF];
    } else if (keysym > 0x0AA0 && keysym < 0x0AFF) {
        uint16_t utf_0AA1_0AFE[] = {
                    0x2003, 0x2002, 0x2004, 0x2005, 0x2007, 0x2008, 0x2009, /* 0x0AA0-0x0AA7 */
            0x200A, 0x2014, 0x2013, 0x0000, 0x0000, 0x0000, 0x2026, 0x2025, /* 0x0AA8-0x0AAF */
            0x2153, 0x2154, 0x2155, 0x2156, 0x2157, 0x2158, 0x2159, 0x215A, /* 0x0AB0-0x0AB7 */
            0x2105, 0x0000, 0x0000, 0x2012, 0x2039, 0x2024, 0x203A, 0x0000, /* 0x0AB8-0x0ABF */
            0x0000, 0x0000, 0x0000, 0x215B, 0x215C, 0x215D, 0x215E, 0x0000, /* 0x0AC0-0x0AC7 */
            0x0000, 0x2122, 0x2120, 0x0000, 0x25C1, 0x25B7, 0x25CB, 0x25AD, /* 0x0AC8-0x0ACF */
            0x2018, 0x2019, 0x201C, 0x201D, 0x211E, 0x2030, 0x2032, 0x2033, /* 0x0AD0-0x0AD7 */
            0x0000, 0x271D, 0x0000, 0x220E, 0x25C2, 0x2023, 0x25CF, 0x25AC, /* 0x0AD8-0x0ADF */
            0x25E6, 0x25AB, 0x25AE, 0x25B5, 0x25BF, 0x2606, 0x2022, 0x25AA, /* 0x0AE0-0x0AE7 */
            0x25B4, 0x25BE, 0x261A, 0x261B, 0x2663, 0x2666, 0x2665, 0x0000, /* 0x0AE8-0x0AEF */
            0x2720, 0x2020, 0x2021, 0x2713, 0x2612, 0x266F, 0x266D, 0x2642, /* 0x0AF0-0x0AF7 */
            0x2640, 0x2121, 0x2315, 0x2117, 0x2038, 0x201A, 0x201E          /* 0x0AF8-0x0AFF */
        };
        data->utf = (uint32_t)utf_0AA1_0AFE[keysym - 0x0AA1];
    } else if (keysym > 0x0CDE && keysym < 0x0CFB) {
        uint16_t utf_0CDF_0CFA[] = {
                                                                    0x2017, /* 0x0CD8-0x0CDF */
            0x05D0, 0x05D1, 0x05D2, 0x05D3, 0x05D4, 0x05D5, 0x05D6, 0x05D7, /* 0x0CE0-0x0CE7 */
            0x05D8, 0x05D9, 0x05DA, 0x05DB, 0x05DC, 0x05DD, 0x05DE, 0x05DF, /* 0x0CE8-0x0CEF */
            0x05E0, 0x05E1, 0x05E2, 0x05E3, 0x05E4, 0x05E5, 0x05E6, 0x05E7, /* 0x0CF0-0x0CF7 */
            0x05E8, 0x05E9, 0x05EA                                          /* 0x0CF8-0x0CFF */
        };
        data->utf = (uint32_t)utf_0CDF_0CFA[keysym - 0x0CDF];
    } else if (keysym > 0x0DA0 && keysym < 0x0DFA) {
        uint16_t utf_0DA1_0DF9[] = {
                    0x0E01, 0x0E02, 0x0E03, 0x0E04, 0x0E05, 0x0E06, 0x0E07, /* 0x0DA0-0x0DA7 */
            0x0E08, 0x0E09, 0x0E0A, 0x0E0B, 0x0E0C, 0x0E0D, 0x0E0E, 0x0E0F, /* 0x0DA8-0x0DAF */
            0x0E10, 0x0E11, 0x0E12, 0x0E13, 0x0E14, 0x0E15, 0x0E16, 0x0E17, /* 0x0DB0-0x0DB7 */
            0x0E18, 0x0E19, 0x0E1A, 0x0E1B, 0x0E1C, 0x0E1D, 0x0E1E, 0x0E1F, /* 0x0DB8-0x0DBF */
            0x0E20, 0x0E21, 0x0E22, 0x0E23, 0x0E24, 0x0E25, 0x0E26, 0x0E27, /* 0x0DC0-0x0DC7 */
            0x0E28, 0x0E29, 0x0E2A, 0x0E2B, 0x0E2C, 0x0E2D, 0x0E2E, 0x0E2F, /* 0x0DC8-0x0DCF */
            0x0E30, 0x0E31, 0x0E32, 0x0E33, 0x0E34, 0x0E35, 0x0E36, 0x0E37, /* 0x0DD0-0x0DD7 */
            0x0E38, 0x0E39, 0x0E3A, 0x0000, 0x0000, 0x0000, 0x0E3E, 0x0E3F, /* 0x0DD8-0x0DDF */
            0x0E40, 0x0E41, 0x0E42, 0x0E43, 0x0E44, 0x0E45, 0x0E46, 0x0E47, /* 0x0DE0-0x0DE7 */
            0x0E48, 0x0E49, 0x0E4A, 0x0E4B, 0x0E4C, 0x0E4D, 0x0000, 0x0000, /* 0x0DE8-0x0DEF */
            0x0E50, 0x0E51, 0x0E52, 0x0E53, 0x0E54, 0x0E55, 0x0E56, 0x0E57, /* 0x0DF0-0x0DF7 */
            0x0E58, 0x0E59                                                  /* 0x0DF8-0x0DFF */
        };
        data->utf = (uint32_t)utf_0DA1_0DF9[keysym - 0x0DA1];
    } else if (keysym > 0x0E9F && keysym < 0x0F00) {
        uint16_t utf_0EA0_0EFF[] = {
            0x0000, 0x1101, 0x1101, 0x11AA, 0x1102, 0x11AC, 0x11AD, 0x1103, /* 0x0EA0-0x0EA7 */
            0x1104, 0x1105, 0x11B0, 0x11B1, 0x11B2, 0x11B3, 0x11B4, 0x11B5, /* 0x0EA8-0x0EAF */
            0x11B6, 0x1106, 0x1107, 0x1108, 0x11B9, 0x1109, 0x110A, 0x110B, /* 0x0EB0-0x0EB7 */
            0x110C, 0x110D, 0x110E, 0x110F, 0x1110, 0x1111, 0x1112, 0x1161, /* 0x0EB8-0x0EBF */
            0x1162, 0x1163, 0x1164, 0x1165, 0x1166, 0x1167, 0x1168, 0x1169, /* 0x0EC0-0x0EC7 */
            0x116A, 0x116B, 0x116C, 0x116D, 0x116E, 0x116F, 0x1170, 0x1171, /* 0x0EC8-0x0ECF */
            0x1172, 0x1173, 0x1174, 0x1175, 0x11A8, 0x11A9, 0x11AA, 0x11AB, /* 0x0ED0-0x0ED7 */
            0x11AC, 0x11AD, 0x11AE, 0x11AF, 0x11B0, 0x11B1, 0x11B2, 0x11B3, /* 0x0ED8-0x0EDF */
            0x11B4, 0x11B5, 0x11B6, 0x11B7, 0x11B8, 0x11B9, 0x11BA, 0x11BB, /* 0x0EE0-0x0EE7 */
            0x11BC, 0x11BD, 0x11BE, 0x11BF, 0x11C0, 0x11C1, 0x11C2, 0x0000, /* 0x0EE8-0x0EEF */
            0x0000, 0x0000, 0x1140, 0x0000, 0x0000, 0x1159, 0x119E, 0x0000, /* 0x0EF0-0x0EF7 */
            0x11EB, 0x0000, 0x11F9, 0x0000, 0x0000, 0x0000, 0x0000, 0x20A9, /* 0x0EF8-0x0EFF */
        };
        data->utf = (uint32_t)utf_0EA0_0EFF[keysym - 0x0EA0];
    } else if (keysym > 0x12A0 && keysym < 0x12FF) {
        uint16_t utf_12A1_12FE[] = {
                    0x1E02, 0x1E03, 0x0000, 0x0000, 0x0000, 0x1E0A, 0x0000, /* 0x12A0-0x12A7 */
            0x1E80, 0x0000, 0x1E82, 0x1E0B, 0x1EF2, 0x0000, 0x0000, 0x0000, /* 0x12A8-0x12AF */
            0x1E1E, 0x1E1F, 0x0000, 0x0000, 0x1E40, 0x1E41, 0x0000, 0x1E56, /* 0x12B0-0x12B7 */
            0x1E81, 0x1E57, 0x1E83, 0x1E60, 0x1EF3, 0x1E84, 0x1E85, 0x1E61, /* 0x12B8-0x12BF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x12C0-0x12C7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x12C8-0x12CF */
            0x0174, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x1E6A, /* 0x12D0-0x12D7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0176, 0x0000, /* 0x12D8-0x12DF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x12E0-0x12E7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x12E8-0x12EF */
            0x0175, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x1E6B, /* 0x12F0-0x12F7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0177          /* 0x12F0-0x12FF */
        };
        data->utf = (uint32_t)utf_12A1_12FE[keysym - 0x12A1];
    } else if (keysym > 0x13BB && keysym < 0x13BF) {
        uint16_t utf_13BC_13BE[] = {
                                            0x0152, 0x0153, 0x0178          /* 0x13B8-0x13BF */
        };
        data->utf = (uint32_t)utf_13BC_13BE[keysym - 0x13BC];
    } else if (keysym > 0x14A0 && keysym < 0x1500) {
        uint16_t utf_14A1_14FF[] = {
                    0x2741, 0x00A7, 0x0589, 0x0029, 0x0028, 0x00BB, 0x00AB, /* 0x14A0-0x14A7 */
            0x2014, 0x002E, 0x055D, 0x002C, 0x2013, 0x058A, 0x2026, 0x055C, /* 0x14A8-0x14AF */
            0x055B, 0x055E, 0x0531, 0x0561, 0x0532, 0x0562, 0x0533, 0x0563, /* 0x14B0-0x14B7 */
            0x0534, 0x0564, 0x0535, 0x0565, 0x0536, 0x0566, 0x0537, 0x0567, /* 0x14B8-0x14BF */
            0x0538, 0x0568, 0x0539, 0x0569, 0x053A, 0x056A, 0x053B, 0x056B, /* 0x14C0-0x14C7 */
            0x053C, 0x056C, 0x053D, 0x056D, 0x053E, 0x056E, 0x053F, 0x056F, /* 0x14C8-0x14CF */
            0x0540, 0x0570, 0x0541, 0x0571, 0x0542, 0x0572, 0x0543, 0x0573, /* 0x14D0-0x14D7 */
            0x0544, 0x0574, 0x0545, 0x0575, 0x0546, 0x0576, 0x0547, 0x0577, /* 0x14D8-0x14DF */
            0x0548, 0x0578, 0x0549, 0x0579, 0x054A, 0x057A, 0x054B, 0x057B, /* 0x14E0-0x14E7 */
            0x054C, 0x057C, 0x054D, 0x057D, 0x054E, 0x057E, 0x054F, 0x057F, /* 0x14E8-0x14EF */
            0x0550, 0x0580, 0x0551, 0x0581, 0x0552, 0x0582, 0x0553, 0x0583, /* 0x14F0-0x14F7 */
            0x0554, 0x0584, 0x0555, 0x0585, 0x0556, 0x0586, 0x2019, 0x0027, /* 0x14F8-0x14FF */
        };
        data->utf = (uint32_t)utf_14A1_14FF[keysym - 0x14A1];
    } else if (keysym > 0x15CF && keysym < 0x15F7) {
        uint16_t utf_15D0_15F6[] = {
            0x10D0, 0x10D1, 0x10D2, 0x10D3, 0x10D4, 0x10D5, 0x10D6, 0x10D7, /* 0x15D0-0x15D7 */
            0x10D8, 0x10D9, 0x10DA, 0x10DB, 0x10DC, 0x10DD, 0x10DE, 0x10DF, /* 0x15D8-0x15DF */
            0x10E0, 0x10E1, 0x10E2, 0x10E3, 0x10E4, 0x10E5, 0x10E6, 0x10E7, /* 0x15E0-0x15E7 */
            0x10E8, 0x10E9, 0x10EA, 0x10EB, 0x10EC, 0x10ED, 0x10EE, 0x10EF, /* 0x15E8-0x15EF */
            0x10F0, 0x10F1, 0x10F2, 0x10F3, 0x10F4, 0x10F5, 0x10F6          /* 0x15F0-0x15F7 */
        };
        data->utf = (uint32_t)utf_15D0_15F6[keysym - 0x15D0];
    } else if (keysym > 0x169F && keysym < 0x16F7) {
        uint16_t utf_16A0_16F6[] = {
            0x0000, 0x0000, 0xF0A2, 0x1E8A, 0x0000, 0xF0A5, 0x012C, 0xF0A7, /* 0x16A0-0x16A7 */
            0xF0A8, 0x01B5, 0x01E6, 0x0000, 0x0000, 0x0000, 0x0000, 0x019F, /* 0x16A8-0x16AF */
            0x0000, 0x0000, 0xF0B2, 0x1E8B, 0x01D1, 0xF0B5, 0x012D, 0xF0B7, /* 0x16B0-0x16B7 */
            0xF0B8, 0x01B6, 0x01E7, 0x0000, 0x0000, 0x01D2, 0x0000, 0x0275, /* 0x16B8-0x16BF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x018F, 0x0000, /* 0x16C0-0x16C7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x16C8-0x16CF */
            0x0000, 0x1E36, 0xF0D2, 0xF0D3, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x16D0-0x16D7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x16D8-0x16DF */
            0x0000, 0x1E37, 0xF0E2, 0xF0E3, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x16E0-0x16E7 */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 0x16E8-0x16EF */
            0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0259          /* 0x16F0-0x16F6 */
        };
        data->utf = (uint32_t)utf_16A0_16F6[keysym - 0x16A0];
    } else if (keysym > 0x1E9E && keysym < 0x1F00) {
        uint16_t utf_1E9F_1EFF[] = {
                                                                    0x0303,
            0x1EA0, 0x1EA1, 0x1EA2, 0x1EA3, 0x1EA4, 0x1EA5, 0x1EA6, 0x1EA7, /* 0x1EA0-0x1EA7 */
            0x1EA8, 0x1EA9, 0x1EAA, 0x1EAB, 0x1EAC, 0x1EAD, 0x1EAE, 0x1EAF, /* 0x1EA8-0x1EAF */
            0x1EB0, 0x1EB1, 0x1EB2, 0x1EB3, 0x1EB4, 0x1EB5, 0x1EB6, 0x1EB7, /* 0x1EB0-0x1EB7 */
            0x1EB8, 0x1EB9, 0x1EBA, 0x1EBB, 0x1EBC, 0x1EBD, 0x1EBE, 0x1EBF, /* 0x1EB8-0x1EBF */
            0x1EC0, 0x1EC1, 0x1EC2, 0x1EC3, 0x1EC4, 0x1EC5, 0x1EC6, 0x1EC7, /* 0x1EC0-0x1EC7 */
            0x1EC8, 0x1EC9, 0x1ECA, 0x1ECB, 0x1ECC, 0x1ECD, 0x1ECE, 0x1ECF, /* 0x1EC8-0x1ECF */
            0x1ED0, 0x1ED1, 0x1ED2, 0x1ED3, 0x1ED4, 0x1ED5, 0x1ED6, 0x1ED7, /* 0x1ED0-0x1ED7 */
            0x1ED8, 0x1ED9, 0x1EDA, 0x1EDB, 0x1EDC, 0x1EDD, 0x1EDE, 0x1EDF, /* 0x1ED8-0x1EDF */
            0x1EE0, 0x1EE1, 0x1EE2, 0x1EE3, 0x1EE4, 0x1EE5, 0x1EE6, 0x1EE7, /* 0x1EE0-0x1EE7 */
            0x1EE8, 0x1EE9, 0x1EEA, 0x1EEB, 0x1EEC, 0x1EED, 0x1EEE, 0x1EEF, /* 0x1EE8-0x1EEF */
            0x1EF0, 0x1EF1, 0x0300, 0x0301, 0x1EF4, 0x1EF5, 0x1EF6, 0x1EF7, /* 0x1EF0-0x1EF7 */
            0x1EF8, 0x1EF9, 0x01A0, 0x01A1, 0x01AF, 0x01B0, 0x0309, 0x0323  /* 0x1EF8-0x1EFF */
        };
        data->utf = (uint32_t)utf_1E9F_1EFF[keysym - 0x1E9F];
    } else if (keysym > 0x209F && keysym < 0x20AD) {
        uint16_t utf_20A0_20AC[] = {
            0x20A0, 0x20A1, 0x20A2, 0x20A3, 0x20A4, 0x20A5, 0x20A6, 0x20A7, /* 0x20A0-0x20A7 */
            0x20A8, 0x20A9, 0x20AA, 0x20AB, 0x20AC                          /* 0x20A8-0x20AF */
        };
        data->utf = (uint32_t)utf_20A0_20AC[keysym - 0x20A0];
    } else {
        return 0;
    }
    return 1;
}
